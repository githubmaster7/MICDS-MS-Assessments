:root{
  --bg:#f3f4f6;
  --card:#ffffff;
  --ink:#111827;
  --muted:#6b7280;
  --grid:#d1d5db;        /* spreadsheet-ish grid */
  --grid-soft:#e5e7eb;
  --blue:#1e40af;
  --red:#b91c1c;

  /* score colors (close to sheet vibes) */
  --s4:#b7f7b7;
  --s3:#cfeccb;
  --s2:#fff3b0;
  --s1:#f8c0c0;
}

*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font-family:Arial,Helvetica,sans-serif}
.hidden{display:none}

.sheet-wrap{max-width:760px;margin:12vh auto;padding:0 14px}
.sheet-card{
  background:var(--card);
  border:1px solid var(--grid);
  border-radius:8px;
  padding:14px;
}
.sheet-card.inner{border-color:var(--grid-soft)}
.sheet-title{font-weight:800;font-size:22px;letter-spacing:.2px}
.sheet-subtitle{margin-top:6px;color:var(--muted);font-size:13px;line-height:1.3}

.topbar{
  position:sticky;top:0;z-index:10;
  background:#fff;border-bottom:1px solid var(--grid);
  padding:10px 12px;
  display:flex;justify-content:space-between;align-items:center;
}
.brand{font-weight:800}
.topbar-left{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.topbar-right{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.pill{
  border:1px solid var(--grid);
  border-radius:999px;
  padding:6px 10px;
  font-size:12px;
  background:#fff;
}

.btn{
  border:1px solid var(--grid);
  background:#fff;
  border-radius:6px;
  padding:8px 10px;
  font-size:13px;
  cursor:pointer;
}
.btn.primary{background:var(--blue);color:#fff;border-color:var(--blue)}
.btn.danger{background:var(--red);color:#fff;border-color:var(--red)}
.btn.ghost{background:#fff}
.btn.small{padding:7px 9px;font-size:12px}
.filebtn input{display:none}

.error{margin-top:10px;color:var(--red);font-size:13px}
.muted{color:var(--muted)}
.small{font-size:13px}
.label{display:block;margin:8px 0 6px;font-size:12px;color:var(--muted)}
.checkbox{display:flex;gap:10px;align-items:flex-start;font-size:13px}

.layout{
  max-width:1250px;margin:14px auto;padding:0 14px;
  display:grid;grid-template-columns:310px 1fr;gap:14px;
}
.sidebar{height:calc(100vh - 86px);position:sticky;top:62px;overflow:auto}
.sidebar-title{font-weight:800;margin-bottom:8px}
.divider{height:1px;background:var(--grid-soft);margin:12px 0}

.navbtn{
  width:100%;
  text-align:left;
  border:1px solid var(--grid);
  border-radius:6px;
  padding:8px 10px;
  margin:6px 0;
  background:#fff;
  cursor:pointer;
  font-size:13px;
}
.navbtn.active{outline:2px solid rgba(30,64,175,.20);border-color:rgba(30,64,175,.45)}

.content{min-height:60vh}
.view{margin-bottom:14px}

.sheet-h2{font-weight:800;font-size:18px;margin-bottom:10px}
.sheet-h3{font-weight:800;font-size:14px;margin-bottom:8px}

.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.kpi{display:flex;flex-direction:column;gap:2px}
.kpi-big{font-size:40px;font-weight:900;line-height:1}
.kpi-row{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
.kpi-mini{border:1px solid var(--grid-soft);border-radius:8px;padding:10px}
.kpi-mid{font-size:22px;font-weight:900;line-height:1.1;margin-top:3px}

/* Spreadsheet table */
.table-wrap{overflow:auto}
.sheet-table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
  font-size:13px;
}
.sheet-table th, .sheet-table td{
  border:1px solid var(--grid);
  padding:8px 8px;
  vertical-align:top;
  background:#fff;
}
.sheet-table th{
  background:#f9fafb;
  font-weight:800;
}
.sheet-table .col-skill{width:48%}
.sheet-table .col-student{width:26%}
.sheet-table .col-teacher{width:26%}

select, textarea, input[type="number"], input[type="text"]{
  width:100%;
  border:1px solid var(--grid);
  border-radius:4px;
  padding:7px 8px;
  font-size:13px;
  background:#fff;
}
textarea{min-height:72px;resize:vertical}

.cell-4{background:var(--s4) !important}
.cell-3{background:var(--s3) !important}
.cell-2{background:var(--s2) !important}
.cell-1{background:var(--s1) !important}

.badge{
  display:inline-block;
  border:1px solid var(--grid);
  border-radius:999px;
  padding:2px 8px;
  font-size:11px;
  color:var(--muted);
  margin-left:6px;
}
